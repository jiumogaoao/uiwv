<html ng-app="app" ng-controller="controller" style="height: {{getH}}px;">
    <head>
        <meta charset="utf-8">
            <meta name="format-detection" content="telephone=no">
                <meta name="msapplication-tap-highlight" content="no">
                    <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width">
                        <title></title>
                            <link href="css/main.css" rel="stylesheet" rev="stylesheet" type="text/css">
                            <link rel="stylesheet" href="font/iconfont.css">
                                <script type="text/javascript" src="js/angular.min.js"></script>
                                <script type="text/javascript" src="js/angular-touch.min.js"></script>
                                <style type="text/css">
                                		.space{
                                			width: 1px;
                                			height: 1px;
                                		}
                                		.top{
                                            width: 750px;
                                            height: 369px;
                                            position: relative;
                                        }
                                        .top .dsc{
                                            width: 750px;
                                            position: absolute;
                                            left: 0px;
                                            bottom: 0px;
                                            background-color: rgba(0,0,0,0.3);
                                            color: #fff;
                                            line-height: 70px;
                                            height: 70px;
                                            font-size: 32px;
                                            text-indent: 20px;
                                        }
                                        .point0{
                                            height: 150px;
                                            width: 710px;
                                            margin: auto;
                                            margin-top:50px; 
                                        }
                                        .point0 .left{
                                            float: left;
                                            width: 488px;
                                            height: 150px;
                                            position: relative;
                                        }
                                        .point0 .right{
                                            float: left;
                                            height: 150px;
                                            width: 222px;
                                        }
                                        .point0 .title{
                                            font-size: 28px;
                                            width: 458px;
                                        }
                                        .point .praise{
                                            position: absolute;
                                            left: 0px;
                                            bottom: 10px;
                                            color: #abadaf;
                                            font-size: 22px;
                                        }
                                        .point .praise span{
                                            font-size: 34px;
                                        }
                                        .point .date{
                                            position: absolute;
                                            right: 0px;
                                            bottom: 10px;
                                            color: #abadaf;
                                            font-size: 22px;
                                        }
                                        .point1{
                                            height: 235px;
                                            width: 710px;
                                            margin: auto;
                                            margin-top:50px; 
                                            position: relative;
                                        }
                                        .point1 .title{
                                            font-size: 28px;
                                        }
                                        .point1 .icon{
                                            float: left;
                                            width: 222px;
                                            height: 150px;
                                            margin-top:13px;
                                            margin-right:22px;  
                                        }
                                        .point1 .icon.last{
                                            margin-right:0px;  
                                        }
                                        .rollFrame{
                                            width: 750px;
                                            position: relative;
                                            overflow: hidden;
                                        }
                                        .roll{
                                            position: relative;
                                            width: {{data.length*750}}px;
                                            transition-timing-function: cubic-bezier(0.1, 0.57, 0.1, 1);
                                    transition-duration: 300ms;
                                    -webkit-transform: translateX(-{{hl*750}}px);
                                       -moz-transform: translateX(-{{hl*750}}px);
                                        -ms-transform: translateX(-{{hl*750}}px);
                                         -o-transform: translateX(-{{hl*750}}px);
                                            transform: translateX(-{{hl*750}}px); 
                                        }
                                        .listFrame{
                                            width: 750px;
                                            float: left;
                                        }
                                        .typeSearch{
                                            width: 750px;
                                            position: absolute;
                                            top: 0px;
                                            left: 0px;
                                            z-index: 3;
                                            background-color: #eeeeee;
                                            min-height: 1000px;
                                            transition-timing-function: cubic-bezier(0.1, 0.57, 0.1, 1);
                                    transition-duration: 300ms;
                                    -webkit-transform: translateY(-{{open?0:100}}%);
                                       -moz-transform: translateY(-{{open?0:100}}%);
                                        -ms-transform: translateY(-{{open?0:100}}%);
                                         -o-transform: translateY(-{{open?0:100}}%);
                                            transform: translateY(-{{open?0:100}}%); 
                                        }
                                        .typePoint{
                                            margin-top:48px;
                                            margin-right: 39px;
                                            width: 210px;
                                            height: 73px;
                                            text-align: center;
                                            line-height: 71px;
                                            background-color: #fff;
                                            position: relative;
                                            left: 20px; 
                                            float: left;   
                                        }
                                        .typePoint.nm{
                                            margin-right:0px; 
                                        }
										.typeTitle{
											color:#5b99ec;
											margin-top:38px;
											margin-left:25px;
											font-size:28px;
											}
										.searchHistory{
											color:#333333;
											margin-top:38px;
											margin-left:25px;
											font-size:28px;
											}
										.cutOff{
											width:710px;
											height:1px;
											background-color:#f6f4f4;
											margin:auto;
											margin-top:38px;
											}
                                </style>
    </head>
    <body style="height: {{getH}}px;">
        <div id="all" style="-webkit-transform:scale({{scale}});transform:scale({{scale}});">
            <div id="main">
                <div class="typeSearch">
                    <div class="space"></div>
                    <div class="typeTitle" ng-if="history.length">搜索历史</div>
                    <button class="searchHistory" ng-repeat="n in history track by $index">{{n}}</button>
                    <div class="cutOff"></div>
                    <div class="typeTitle">全部分类</div>
                    <div class="clear"></div>
                    <button ng-repeat="list in data track by $index" class="typePoint {{($index+1)%3?'':'nm'}}" ng-click="choose($index)">{{$index}}{{list.title}}</button>
                    <div class="clear"></div>
                </div>
                <div class="rollFrame" ng-if="!open" ng-swipe-left="rollLeft()"  ng-swipe-right="rollRight()">
                    <div class="roll">
                        <div class="listFrame" ng-repeat="list in data track by $index">
                            <div class="space"></div>
                            <div class="list" ng-if="$index==hl">
                                <div class="top" style="background-image: url('{{list.icon}}')">
                                    <div class="dsc">{{list.dsc}}</div>
                                </div>
                                <div ng-repeat="n in list.list track by $index" class="point point{{n.type}}"  ng-switch="n.type">
                                    <div ng-switch-when="0">
                                        <div class="left">
                                            <div class="title">{{n.title}}</div>
                                            <div class="praise"><span class="iconfont">&#xe654;</span> {{n.praise}}</div>
                                            <div class="date">{{n.time}}</div>
                                        </div>
                                        <div class="right" style="background-image: url('{{n.icon}}')"></div>
                                        <div class="clear"></div>
                                    </div>
                                    <div ng-switch-when="1">
                                        <div class="title">{{n.title}}</div>
                                        <div class="clear"></div>
                                        <div ng-repeat="i in n.icon track by $index" class="icon {{$index==2?'last':''}}" style="background-image: url('{{i}}')"></div>
                                        <div class="clear"></div>
                                        <div class="praise"><span class="iconfont">&#xe654;</span>{{n.praise}}</div>
                                        <div class="date">{{n.time}}</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                </div>
                
            </div>
        </div>
        <div class="clear"></div>
        <script type="text/javascript">
            angular.module('app', ['ngTouch']).controller('controller', ['$scope','$window','$timeout',function($scope,$window,$timeout) {
                //自适应用
                $scope.scale = $window.innerWidth/750;
                $window.onresize=function(){
                   $scope.scale = $window.innerWidth/750;
                    $scope.getH = document.getElementById('all').clientHeight*$scope.scale;
                    $scope.$apply();
                }
                //数据
                $scope.hl=0;
				$scope.choose=function(index){
					$scope.hl=index;
					$scope.open=false;
					window.webkit.messageHandlers.ZTX.postMessage({
                                                                                                                       fn:"bridge",
                                                                                                                       to:"topView",
                                                                                                                       action:"hl("+index+")"
                                                                                                                       
                                                                                                                       });
					}
                $scope.rollLeft=function(){
                    if($scope.hl<$scope.data.length-1){
                        $scope.hl++;
                    }
                                                                         window.webkit.messageHandlers.ZTX.postMessage({
                                                                                                                                                          fn:"bridge",
                                                                                                                       to:"topView",
                                                                                                                       action:"hl("+$scope.hl+")"
                                                                                                                       
                                                                                                                       });
                }
                $scope.rollRight=function(){
                    if($scope.hl>0){
                        $scope.hl--;
                    }
                                                                         window.webkit.messageHandlers.ZTX.postMessage({
                                                                                                                       fn:"bridge",
                                                                                                                       to:"topView",
                                                                                                                       action:"hl("+$scope.hl+")"
                                                                                                                       
                                                                                                                       });
                }
                $scope.open=true;
				$scope.history=["搜索历史0","搜索历史1","搜索历史2","搜索历史3","搜索历史4"];
                $scope.data=[];
                                                                         //原生调用
                                                                         window.hl=function(num){
                                                                         $scope.hl=num;
                                                                         $scope.$apply();
                                                                         }
                                                                         window.toggle=function(){
                                                                         $scope.open=!$scope.open;
                                                                         $scope.$apply();
                                                                         }
                                                                         window.searching=function(){
                                                                         $scope.serchMode=true;
                                                                         $scope.$apply();
                                                                         }
                                                                         window.cancel=function(){
                                                                         $scope.serchMode=false;
                                                                         $scope.$apply();
                                                                         }
                                                                         window.set=function(data){
                                                                         $scope.data=data;
                                                                         $scope.$apply();
                                                                         }
                $timeout(function(){
                   $scope.getH = document.getElementById('all').clientHeight*$scope.scale; 
                },300);
                                                                
            }]);
            var alertA=function(num){
                alert(num);
            }
        </script>
    </body>
</html>
